
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Channel restoration &#8212; FiNN 0.1.5 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Outlier removal" href="outlier_removal.html" />
    <link rel="prev" title="Bad channel identification" href="bad_channel_identification.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">FiNN</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../basic.html">
  Basic
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../cfc.html">
  Cross frequency connectivity (cfc)
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../cleansing.html">
  Cleansing
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../file_io.html">
  File IO
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../filters.html">
  Filters
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../misc.html">
  Misc
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../sfc.html">
  Same frequency coupling (sfc)
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../statistical.html">
  Statistical
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../visualization.html">
  Visualization
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><h3><a href="../index.html">FiNN</a></h3>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Packages:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../basic.html">Basic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/car.html">Common Average Re-Referencing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/downsample.html">Downsampling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cfc.html">Cross frequency connectivity (cfc)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cfc/dmi.html">Direct Modulation Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cfc/mi.html">Modulation Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cfc/mvl.html">Mean Vector Length</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cfc/plv.html">Phase Lock Value</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../cleansing.html">Cleansing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bad_channel_identification.html">Bad channel identification</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Channel restoration</a></li>
<li class="toctree-l2"><a class="reference internal" href="outlier_removal.html">Outlier removal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../file_io.html">File IO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../file_io/data_manager.html">Data manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../file_io/load_brainvision_data.html">Load brainvision data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../filters.html">Filters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../filters/butter.html">Butterwort filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/fir.html">FIR filter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../misc.html">Misc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/timed_pool.html">Timed Pool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sfc.html">Same frequency coupling (sfc)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../sfc/dac.html">Directional absolute coherence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sfc/psi.html">Phase slope index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sfc/wpli.html">Weighted phase lag index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sfc/im.html">Imaginary coherence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sfc/msc.html">Magnitude squared coherence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sfc/cc.html">Complex coherency</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../statistical.html">Statistical</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../statistical/glmm.html">Generalized linear mixed model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visualization.html">Visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualization/topoplot.html">Topoplot</a></li>
</ul>
</li>
</ul>

<h3>Branches</h3>
<ul>
  <li><a href="../../develop/cleansing/channel_restoration.html">develop</a></li>
  <li><a href="channel_restoration.html">stable</a></li>
</ul>

<h3>Tags</h3>
<ul>
  <li><a href="../../v0.1.5/cleansing/channel_restoration.html">v0.1.5</a></li>
</ul>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="channel-restoration">
<h1>Channel restoration<a class="headerlink" href="#channel-restoration" title="Permalink to this headline">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="cleansing.channel_restoration.run">
<span class="sig-prename descclassname"><span class="pre">cleansing.channel_restoration.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bad_ch_idx_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cleansing.channel_restoration.run" title="Permalink to this definition">#</a></dt>
<dd><p>Restores channel by averaging signals from their respective neighbors. In case neighboring channels are flagged as bad, channels get iteratively restored, from the channel with the most valid neighbors to the channel with the least. Restored channels are considered valid candidates for channel reconstruction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Input data in the format channels x samples.</p></li>
<li><p><strong>ch_names</strong> – Names of the channles from the input data. Order needs to be aligned with the channel order of ch_names.</p></li>
<li><p><strong>bad_ch_idx_list</strong> – List of bad channels with are selected for substitution by their neighbors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Restored channels in the format channels x samples.</p>
</dd>
</dl>
</dd></dl>

<p>The following code example shows how to apply bad channel identification &amp; subsequent restoration.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;Qt5agg&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">finn.cleansing.bad_channel_identification</span> <span class="k">as</span> <span class="nn">bci</span>
<span class="kn">import</span> <span class="nn">finn.cleansing.channel_restoration</span> <span class="k">as</span> <span class="nn">cr</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1">#Configure sample data</span>
    <span class="n">channel_count</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">frequency</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">channel_count</span><span class="p">)]</span>
    <span class="n">data_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">frequency_sampling</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="n">ch_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;O1&#39;</span><span class="p">,</span> <span class="s1">&#39;Oz&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;PO9&#39;</span><span class="p">,</span> <span class="s1">&#39;PO7&#39;</span><span class="p">,</span> <span class="s1">&#39;PO3&#39;</span><span class="p">,</span> <span class="s1">&#39;POz&#39;</span><span class="p">,</span> <span class="s1">&#39;PO4&#39;</span><span class="p">,</span> <span class="s1">&#39;PO8&#39;</span><span class="p">,</span> <span class="s1">&#39;PO10&#39;</span><span class="p">,</span> <span class="s1">&#39;P9&#39;</span><span class="p">,</span> <span class="s1">&#39;P7&#39;</span><span class="p">,</span> <span class="s1">&#39;P5&#39;</span><span class="p">,</span> <span class="s1">&#39;P3&#39;</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;Pz&#39;</span><span class="p">,</span> <span class="s1">&#39;P2&#39;</span><span class="p">,</span> <span class="s1">&#39;P4&#39;</span><span class="p">,</span> <span class="s1">&#39;P6&#39;</span><span class="p">,</span> <span class="s1">&#39;P8&#39;</span><span class="p">,</span> <span class="s1">&#39;P10&#39;</span><span class="p">,</span>
               <span class="s1">&#39;TP9&#39;</span><span class="p">,</span> <span class="s1">&#39;TP7&#39;</span><span class="p">,</span> <span class="s1">&#39;CP5&#39;</span><span class="p">,</span> <span class="s1">&#39;CP3&#39;</span><span class="p">,</span> <span class="s1">&#39;CP1&#39;</span><span class="p">,</span> <span class="s1">&#39;CPz&#39;</span><span class="p">,</span> <span class="s1">&#39;CP2&#39;</span><span class="p">,</span> <span class="s1">&#39;CP4&#39;</span><span class="p">,</span> <span class="s1">&#39;CP6&#39;</span><span class="p">,</span> <span class="s1">&#39;TP8&#39;</span><span class="p">,</span> <span class="s1">&#39;TP10&#39;</span><span class="p">,</span> <span class="s1">&#39;T9&#39;</span><span class="p">,</span> <span class="s1">&#39;T7&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;Cz&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;T8&#39;</span><span class="p">,</span> <span class="s1">&#39;T10&#39;</span><span class="p">,</span>
               <span class="s1">&#39;FT9&#39;</span><span class="p">,</span> <span class="s1">&#39;FT7&#39;</span><span class="p">,</span> <span class="s1">&#39;FC5&#39;</span><span class="p">,</span> <span class="s1">&#39;FC3&#39;</span><span class="p">,</span> <span class="s1">&#39;FC1&#39;</span><span class="p">,</span> <span class="s1">&#39;FCz&#39;</span><span class="p">,</span> <span class="s1">&#39;FC2&#39;</span><span class="p">,</span> <span class="s1">&#39;FC4&#39;</span><span class="p">,</span> <span class="s1">&#39;FC6&#39;</span><span class="p">,</span> <span class="s1">&#39;FT8&#39;</span><span class="p">,</span> <span class="s1">&#39;FT10&#39;</span><span class="p">,</span> <span class="s1">&#39;F9&#39;</span><span class="p">,</span> <span class="s1">&#39;F7&#39;</span><span class="p">,</span> <span class="s1">&#39;F5&#39;</span><span class="p">,</span> <span class="s1">&#39;F3&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="s1">&#39;Fz&#39;</span><span class="p">,</span> <span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="s1">&#39;F4&#39;</span><span class="p">,</span> <span class="s1">&#39;F6&#39;</span><span class="p">,</span> <span class="s1">&#39;F8&#39;</span><span class="p">,</span> <span class="s1">&#39;F10&#39;</span><span class="p">,</span>
               <span class="s1">&#39;AF9&#39;</span><span class="p">,</span> <span class="s1">&#39;AF7&#39;</span><span class="p">,</span> <span class="s1">&#39;AF3&#39;</span><span class="p">,</span> <span class="s1">&#39;AFz&#39;</span><span class="p">,</span> <span class="s1">&#39;AF4&#39;</span><span class="p">,</span> <span class="s1">&#39;AF8&#39;</span><span class="p">,</span> <span class="s1">&#39;AF10&#39;</span><span class="p">,</span> <span class="s1">&#39;Fp1&#39;</span><span class="p">,</span> <span class="s1">&#39;Fpz&#39;</span><span class="p">,</span> <span class="s1">&#39;Fp2&#39;</span><span class="p">]</span>

    <span class="c1">#Configure noise data</span>
    <span class="n">frequency_noise</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">shared_noise_strength</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">random_noise_strength</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1">#Configure bad channel</span>
    <span class="n">bad_channel_idx</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">bad_channel_signal_power</span> <span class="o">=</span> <span class="mf">1.1</span>

    <span class="c1">#Generate some sample data</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">channel_count</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">channel_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">channel_count</span><span class="p">):</span>
        <span class="n">genuine_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span><span class="p">[</span><span class="n">channel_idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">data_range</span> <span class="o">/</span> <span class="n">frequency_sampling</span><span class="p">)</span>
        <span class="n">shared_noise_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency_noise</span> <span class="o">*</span> <span class="n">data_range</span> <span class="o">/</span> <span class="n">frequency_sampling</span><span class="p">)</span> <span class="o">*</span> <span class="n">shared_noise_strength</span>
        <span class="n">random_noise_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_range</span><span class="p">))</span> <span class="o">*</span> <span class="n">random_noise_strength</span>

        <span class="n">raw_data</span><span class="p">[</span><span class="n">channel_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">genuine_signal</span> <span class="o">+</span> <span class="n">shared_noise_signal</span> <span class="o">+</span> <span class="n">random_noise_signal</span>

    <span class="n">raw_data</span><span class="p">[</span><span class="n">bad_channel_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_range</span><span class="p">))</span> <span class="o">*</span> <span class="n">bad_channel_signal_power</span>
    <span class="c1">#raw_data = np.asarray(raw_data)</span>

    <span class="c1">#Faulty channel gets identified</span>
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">invalid_list</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">bci</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">ch_names</span><span class="p">,</span> <span class="p">[</span><span class="n">frequency_sampling</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">channel_count</span><span class="p">)],</span> <span class="p">[[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">100</span><span class="p">]],</span> <span class="n">broadness</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">visual_inspection</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="c1">#Faulty channel gets substituted via neighbors</span>
    <span class="n">rest_data</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">ch_names</span><span class="p">,</span> <span class="n">invalid_list</span><span class="p">)</span>

    <span class="c1">#visualization</span>
    <span class="n">channels_to_plot</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">channels_to_plot</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">channel_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">channels_to_plot</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">channel_idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="n">channel_idx</span><span class="p">][:</span><span class="mi">200</span><span class="p">])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">channel_idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rest_data</span><span class="p">[</span><span class="n">channel_idx</span><span class="p">][:</span><span class="mi">200</span><span class="p">])</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;before correction&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;after correction&quot;</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Channel #0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Channel #1</span><span class="se">\n</span><span class="s2">(faulty channel)&quot;</span><span class="p">);</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Channel #2</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">);</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>Having identified bad channels, those got restored by averaging activity from their neighbors.</p>
<img alt="../_images/channel_restoration.png" src="../_images/channel_restoration.png" />
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="bad_channel_identification.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Bad channel identification</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="outlier_removal.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Outlier removal</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, Maximilian Scherer.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.2.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>